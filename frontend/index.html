<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>VibeFixer</title>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap");

      html, body {
        margin: 0;
        padding: 0;
        height: 100%;
        background: #0f0f1a;
        color: #f5f5f5;
        font-family: monospace;
        overflow-y: auto;
      }
      .page {
        min-height: 100%;
        display: flex;
        flex-direction: column;
      }
      #vibefixer-canvas {
        display: block;
        border: 0;
        background: #1e1e2f;
      }
      .logo {
        max-width: 1024px;
        margin: 16px auto 8px;
        text-align: center;
        font-size: 42px;
        letter-spacing: 4px;
        color: #7df9ff;
        font-family: "Press Start 2P", monospace;
        text-transform: uppercase;
        text-shadow:
          0 0 6px rgba(125, 249, 255, 0.8),
          0 0 16px rgba(125, 249, 255, 0.6),
          2px 2px 0 #0a0a14;
      }
      .logo span {
        display: inline-block;
        padding: 6px 14px;
        border: 3px solid #5fd1ff;
        background: linear-gradient(180deg, #1d2b64 0%, #1c1c2d 100%);
        box-shadow: inset 0 0 0 2px #0a0a14;
      }
      .controls {
        text-align: left;
        font-size: 14px;
        color: #d7d7df;
        padding: 10px 14px;
        background: rgba(12, 12, 24, 0.7);
        border: 2px solid #2b4b6f;
        box-shadow: inset 0 0 0 2px #0a0a14;
        letter-spacing: 0.5px;
      }
      .controls strong {
        color: #5fd1ff;
        text-transform: uppercase;
        letter-spacing: 2px;
        margin-right: 6px;
        display: block;
        margin-bottom: 8px;
      }
      .controls span {
        display: block;
        line-height: 1.6;
      }
      .language-selector {
        max-width: 1024px;
        margin: 8px auto 0;
        display: flex;
        justify-content: center;
        gap: 8px;
        font-size: 14px;
        color: #d7d7df;
      }
      .basement-notices {
        max-width: 1024px;
        margin: 12px auto 0;
        display: flex;
        flex-direction: column;
        gap: 10px;
        padding: 0 12px;
      }
      .basement-notice {
        background: rgba(12, 12, 24, 0.8);
        border: 2px solid #5fd1ff;
        box-shadow: inset 0 0 0 2px #0a0a14;
        padding: 12px 14px;
        font-size: 12px;
        color: #dbe5ff;
        display: flex;
        flex-direction: column;
        gap: 8px;
      }
      .basement-notice h4 {
        margin: 0;
        font-size: 13px;
        letter-spacing: 1px;
        text-transform: uppercase;
        color: #7df9ff;
      }
      .basement-notice p {
        margin: 0;
        line-height: 1.5;
      }
      .basement-notice button {
        align-self: flex-start;
        background: rgba(12, 12, 24, 0.7);
        border: 2px solid #2b4b6f;
        color: #f5f5f5;
        padding: 4px 10px;
        font-family: monospace;
        font-size: 11px;
        letter-spacing: 1px;
        text-transform: uppercase;
        cursor: pointer;
      }
      .info-panels {
        max-width: 505px;
        margin: 12px auto 0;
        display: flex;
        gap: 12px;
      }
      .info-panels .controls,
      .info-panels #session-stats {
        flex: 1 1 0;
      }
      .language-selector label {
        letter-spacing: 1px;
      }
      .language-selector select {
        background: #101425;
        color: #f5f5f5;
        border: 1px solid #2b4b6f;
        padding: 2px 6px;
        font-family: monospace;
      }
      .intro-story {
        max-width: 505px;
        margin: 20px auto 0;
        padding: 16px 18px;
        background: rgba(12, 12, 24, 0.7);
        border: 2px solid #2b4b6f;
        box-shadow: inset 0 0 0 2px #0a0a14;
        font-size: 14px;
        line-height: 1.6;
        color: #dbe5ff;
      }
      .intro-story h3 {
        margin: 0 0 8px;
        font-size: 16px;
        letter-spacing: 2px;
        text-transform: uppercase;
        color: #5fd1ff;
      }
      #game-shell {
        display: flex;
        justify-content: center;
        gap: 16px;
        margin: 16px auto 0;
        max-width: 1280px;
        align-items: flex-start;
      }
      #side-panel {
        width: 260px;
        height: 683px;
        display: flex;
        flex-direction: column;
        gap: 12px;
      }
      #event-log,
      #po-status {
        background: rgba(12, 12, 24, 0.7);
        border: 2px solid #2b4b6f;
        box-shadow: inset 0 0 0 2px #0a0a14;
        padding: 12px;
        flex: 1;
      }
      #event-log {
        max-height: 45%;
        overflow: hidden;
      }
      #event-log h3,
      #po-status h3 {
        margin: 0 0 8px;
        font-size: 14px;
        letter-spacing: 1px;
        text-transform: uppercase;
        color: #5fd1ff;
      }
      #po-status {
        display: flex;
        flex-direction: column;
      }
      #po-status img {
        max-width: 100%;
        max-height: 100%;
        display: block;
        margin: 0 auto;
        image-rendering: pixelated;
      }
      #event-log ul {
        list-style: none;
        padding: 0;
        margin: 0;
        font-size: 12px;
        line-height: 1.4;
        color: #d7e2ff;
      }
      #event-log li {
        margin-bottom: 8px;
      }
      #session-stats {
        padding: 12px 14px;
        background: rgba(12, 12, 24, 0.7);
        border: 2px solid #2b4b6f;
        box-shadow: inset 0 0 0 2px #0a0a14;
        font-size: 12px;
        color: #d7e2ff;
      }
      #session-stats h3 {
        margin: 0 0 8px;
        font-size: 14px;
        letter-spacing: 1px;
        text-transform: uppercase;
        color: #5fd1ff;
      }
      #session-stats ul {
        list-style: none;
        padding: 0;
        margin: 0;
        line-height: 1.5;
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
        gap: 4px 12px;
      }
      #session-stats li {
        margin: 0;
      }
      .high-score-prompt {
        max-width: 505px;
        margin: 16px auto 0;
        padding: 16px 18px;
        background: rgba(12, 12, 24, 0.75);
        border: 2px solid #2b4b6f;
        box-shadow: inset 0 0 0 2px #0a0a14;
        color: #dbe5ff;
      }
      .high-score-prompt.hidden {
        display: none;
      }
      .high-score-prompt h3 {
        margin: 0 0 8px;
        font-size: 16px;
        letter-spacing: 2px;
        text-transform: uppercase;
        color: #5fd1ff;
      }
      .high-score-prompt p {
        margin: 0 0 12px;
        font-size: 13px;
      }
      .high-score-form {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }
      .high-score-form label {
        font-size: 12px;
        letter-spacing: 1px;
        text-transform: uppercase;
      }
      .high-score-form input {
        background: #101425;
        color: #f5f5f5;
        border: 1px solid #2b4b6f;
        padding: 6px 8px;
        font-family: monospace;
      }
      .high-score-actions {
        display: flex;
        gap: 8px;
      }
      .high-score-actions button {
        background: rgba(12, 12, 24, 0.7);
        border: 2px solid #2b4b6f;
        color: #f5f5f5;
        padding: 6px 12px;
        font-family: monospace;
        font-size: 12px;
        letter-spacing: 1px;
        text-transform: uppercase;
        cursor: pointer;
      }
      .high-score-actions button:active {
        background: rgba(95, 209, 255, 0.25);
      }
      #game-wrap {
        width: 1024px;
        position: relative;
      }
      #touch-controls {
        position: absolute;
        inset: 0;
        z-index: 5;
        pointer-events: none;
        display: none;
      }
      #touch-controls.visible {
        display: block;
      }
      .touch-cluster {
        position: absolute;
        display: flex;
        gap: 12px;
      }
      .touch-cluster.left {
        left: 16px;
        top: 48px;
      }
      .touch-cluster.right {
        right: 16px;
        bottom: 16px;
      }
      .touch-button {
        pointer-events: auto;
        width: 56px;
        height: 56px;
        border-radius: 12px;
        border: 2px solid #5fd1ff;
        background: rgba(12, 12, 24, 0.6);
        color: #f5f5f5;
        font-family: monospace;
        font-size: 14px;
        text-transform: uppercase;
        touch-action: none;
        user-select: none;
      }
      .touch-button:active {
        background: rgba(95, 209, 255, 0.35);
      }
      #touch-toggle {
        max-width: 1024px;
        margin: 8px auto 0;
        text-align: center;
        display: none;
      }
      #touch-toggle button {
        background: rgba(12, 12, 24, 0.7);
        border: 2px solid #2b4b6f;
        color: #f5f5f5;
        padding: 6px 12px;
        font-family: monospace;
        font-size: 12px;
        letter-spacing: 1px;
        text-transform: uppercase;
        cursor: pointer;
      }
      #touch-toggle button:active {
        background: rgba(95, 209, 255, 0.25);
      }
      @media (pointer: coarse) {
        #touch-toggle {
          display: block;
        }
      }
      .cast, .credits {
        max-width: 1280px;
        margin: 24px auto 0;
        padding: 0 12px 24px;
      }
      .intro-story .cast {
        max-width: none;
        margin: 16px 0 0;
        padding: 0;
      }
      .high-scores {
        max-width: 505px;
        margin: 24px auto 0;
        padding: 0 12px 24px;
      }
      .high-scores h3 {
        margin-bottom: 12px;
        font-size: 16px;
        letter-spacing: 2px;
        text-transform: uppercase;
        color: #7df9ff;
        font-family: "Press Start 2P", monospace;
        text-shadow:
          0 0 6px rgba(125, 249, 255, 0.8),
          0 0 16px rgba(125, 249, 255, 0.6);
      }
      .high-scores ul {
        list-style: none;
        padding: 0;
        margin: 0;
        font-size: 12px;
        line-height: 1.7;
        color: #f4eaff;
        font-family: "Press Start 2P", monospace;
      }
      .high-scores li {
        background: rgba(8, 8, 20, 0.75);
        border: 2px solid #ff5cff;
        padding: 12px 14px;
        margin-bottom: 8px;
        box-shadow:
          0 0 6px rgba(255, 92, 255, 0.65),
          inset 0 0 10px rgba(90, 0, 120, 0.8);
      }
      .high-scores .score-time {
        display: block;
        margin-bottom: 4px;
        font-size: 10px;
        color: #7df9ff;
        text-shadow:
          0 0 6px rgba(125, 249, 255, 0.8),
          0 0 14px rgba(125, 249, 255, 0.6);
      }
      .high-scores .score-tag {
        color: #43ff6b;
        text-shadow:
          0 0 6px rgba(67, 255, 107, 0.85),
          0 0 14px rgba(67, 255, 107, 0.65);
      }
      .cast h3, .credits h3 {
        margin-bottom: 12px;
        font-size: 16px;
        letter-spacing: 2px;
        text-transform: uppercase;
        color: #5fd1ff;
      }
      .version-footer {
        max-width: 1280px;
        margin: 18px auto 24px;
        padding: 0 12px;
        font-size: 11px;
        color: rgba(245, 245, 245, 0.6);
        display: flex;
        flex-direction: column;
        gap: 4px;
        text-align: center;
        letter-spacing: 1px;
        text-transform: uppercase;
      }
      .version-footer a {
        color: #7df9ff;
        text-decoration: none;
      }
      .version-footer a:hover {
        text-decoration: underline;
      }
      .cast-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 16px;
      }
      .intro-story .cast-grid {
        grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      }
      .cast-card {
        background: rgba(12, 12, 24, 0.7);
        border: 2px solid #2b4b6f;
        padding: 12px;
      }
      .cast-card img {
        display: block;
        width: 96px;
        height: 96px;
        image-rendering: pixelated;
        margin-bottom: 8px;
      }
      .cast-card h4 {
        margin: 0 0 4px;
        font-size: 14px;
      }
      .cast-card p {
        margin: 0;
        font-size: 12px;
        color: #c9d4f0;
      }
      .credits ul {
        list-style: none;
        padding: 0;
        margin: 0;
        font-size: 12px;
        line-height: 1.5;
        color: #c9d4f0;
      }
    </style>
  </head>
  <body>
    <div class="page">
      <div class="logo"><span>Vibe Fixer</span></div>
      <div id="basement-notices" class="basement-notices"></div>
      <div id="game-shell">
        <aside id="side-panel">
          <div id="event-log">
            <h3 id="game-events-title">Game Events</h3>
            <ul id="event-log-list"></ul>
          </div>
          <div id="po-status">
            <h3 id="po-status-title">PO Status</h3>
            <img id="po-status-image" alt="Product Owner mood" />
          </div>
        </aside>
        <div id="game-wrap">
          <div id="touch-controls">
            <div class="touch-cluster left">
              <button id="touch-left" class="touch-button" aria-label="Move left">L</button>
              <button id="touch-right" class="touch-button" aria-label="Move right">R</button>
            </div>
            <div class="touch-cluster right">
              <button id="touch-jump" class="touch-button" aria-label="Jump">J</button>
              <button id="touch-action" class="touch-button" aria-label="Action">A</button>
            </div>
          </div>
        </div>
      </div>
      <div class="language-selector">
        <label id="language-label" for="language-select">Language</label>
        <select id="language-select">
          <option value="en">English</option>
          <option value="sv">Swedish</option>
        </select>
      </div>
      <div id="touch-toggle">
        <button id="touch-toggle-button" type="button">Show Touch Controls</button>
      </div>
      <div class="info-panels">
        <div class="controls">
          <strong id="controls-label">Controls:</strong>
          <span id="controls-text">← Move left, → Move right, ↑ Jump, Space Action (Pick up / Drop), M Mute</span>
        </div>
        <div id="session-stats">
          <h3 id="session-stats-title">Session Stats</h3>
          <ul>
            <li><span id="session-stats-active-label">Active</span>: <span id="session-stats-active">0</span></li>
            <li><span id="session-stats-started-label">Started</span>: <span id="session-stats-started">0</span></li>
          <li><span id="session-stats-ended-label">Ended</span>: <span id="session-stats-ended">0</span></li>
          <li><span id="session-stats-stale-label">Auto-ended</span>: <span id="session-stats-stale">0</span></li>
          <li><span id="session-stats-won-label">Won</span>: <span id="session-stats-won">0</span></li>
          <li><span id="session-stats-lost-label">Lost</span>: <span id="session-stats-lost">0</span></li>
          <li><span id="session-stats-abandoned-label">Abandoned</span>: <span id="session-stats-abandoned">0</span></li>
          <li><span id="session-stats-latest-label">Latest ended</span>: <span id="session-stats-latest">—</span></li>
          </ul>
        </div>
      </div>
      <div id="high-score-prompt" class="high-score-prompt hidden">
        <h3 id="high-score-prompt-title">Save Your Run</h3>
        <p id="high-score-prompt-message">You saved the sprint! Add your gamer tag?</p>
        <form id="high-score-form" class="high-score-form">
          <label id="high-score-name-label" for="high-score-name">Gamer tag</label>
          <input id="high-score-name" type="text" maxlength="24" autocomplete="off" />
          <div class="high-score-actions">
            <button id="high-score-save" type="submit">Save</button>
            <button id="high-score-skip" type="button">Skip</button>
          </div>
        </form>
      </div>
      <section class="intro-story">
        <h3 id="story-title">Story</h3>
        <p id="story-text">
          The Vibe Coders have seized the City Hall’s top floor, raining unchecked code into the basement.
          You are the Vibe Fixer — sprint fast, review faster, and keep the code moving before the timer ends.
          If the backlog piles up, the customers’ FOMO Demon wakes and the sprint turns grim.
          Clear blockers to keep the Product Owner calm, but beware Imp Ediment, who teleports in to stack new obstacles.
          Smash a blocker from below to break it, or vault over it if you care more about speed than the PO’s blood pressure.
        </p>
        <section class="cast">
          <h3 id="cast-title">Cast</h3>
          <div class="cast-grid">
            <div class="cast-card">
              <img id="cast-fixer-img" src="/assets/kenney/Sprites/Characters/Double/character_green_idle.png" alt="The Fixer" />
              <h4 id="cast-fixer-name">The Fixer</h4>
              <p id="cast-fixer-bio">Municipality hero, fast on the keyboard and faster on the cleanup.</p>
            </div>
            <div class="cast-card">
              <img id="cast-coder-img" src="/assets/kenney/Sprites/Enemies/Default/barnacle_attack_a.png" alt="Vibe Coder" />
              <h4 id="cast-coder-name">Vibe Coder</h4>
              <p id="cast-coder-bio">Top-floor chaos agent dropping unchecked code at the worst times.</p>
            </div>
            <div class="cast-card">
              <img id="cast-imp-img" src="/src/assets/imp_ediment.png" alt="Imp Ediment" />
              <h4 id="cast-imp-name">Imp Ediment</h4>
              <p id="cast-imp-bio">Teleporting mischief-maker who stacks blockers in your way.</p>
            </div>
            <div class="cast-card">
              <img id="cast-fomo-img" src="/src/assets/fomo_demon.png" alt="FOMO Demon" />
              <h4 id="cast-fomo-name">FOMO Demon</h4>
              <p id="cast-fomo-bio">Feeds on lingering code. Defeat it by keeping the ground clean.</p>
            </div>
            <div class="cast-card">
              <img id="cast-po-img" src="/src/assets/po_happy.png" alt="Product Owner" />
              <h4 id="cast-po-name">Product Owner</h4>
              <p id="cast-po-bio">Guardian of scope and sanity, happiest when blockers hit zero.</p>
            </div>
            <div class="cast-card">
              <img
                id="cast-root-img"
                src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='96' height='96' viewBox='0 0 96 96'><rect width='96' height='96' fill='%23101425'/><rect x='6' y='6' width='84' height='84' fill='%23182036' stroke='%235fd1ff' stroke-width='2'/><text x='50%' y='54%' dominant-baseline='middle' text-anchor='middle' font-size='56' fill='%23d7e2ff' font-family='monospace'>?</text></svg>"
                alt="Root"
              />
              <h4 id="cast-root-name">Root</h4>
              <p id="cast-root-bio">An unseen force refining code-fu in the shadows, waiting for the perfect merge.</p>
            </div>
          </div>
        </section>
      </section>
      <section class="high-scores">
        <h3 id="high-scores-title">High Scores</h3>
        <ul id="high-scores-list"></ul>
      </section>
      <section class="credits">
        <h3 id="credits-title">Credits</h3>
        <ul>
          <li id="credits-kenney">Kenney New Platformer Pack (CC0) — sprites for characters and tiles.</li>
          <li id="credits-audio">OpenGameArt CC0 audio — chiptune music and sound effects.</li>
          <li id="credits-bg">kommun_bg.png background — CC0 by Magnus.</li>
          <li id="credits-custom">Custom sprites (PO + bosses) — Magnus.</li>
          <li id="credits-authors">Co-authors: Magnus &amp; Codex.</li>
        </ul>
      </section>
      <footer class="version-footer">
        <span id="frontend-version">Client v—</span>
        <span id="server-version">Server v—</span>
        <span>
          <a href="/version-history.html">Version History</a> ·
          <a href="https://github.com/snailtail/VibeFixer" target="_blank" rel="noreferrer">GitHub Repo</a>
        </span>
      </footer>
    </div>
    <script type="module" src="/src/app.js"></script>
  </body>
</html>
